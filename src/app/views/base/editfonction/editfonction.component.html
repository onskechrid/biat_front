<c-card class="mb-4">
  <input #name value="{{fun.name}}" type="hidden"/>


    <c-col xs="12">
        <c-card class="mb-3" style="margin: 20px;">
            <c-card-header _ngcontent-tjo-c224="" class="card-header" style="background-color: rgb(240,240,240);">
              <table style="table-layout: fixed; width: 100%;" cTable>
                <tr>
                    <td colSpan="12">
                      <strong _ngcontent-tjo-c224=""> {{fun.name}} </strong>
                    </td>
                    <td>
                      <button _ngcontent-tjo-c219="" cbutton="" class="me-1 btn btn-light" ng-reflect-active="false" ng-reflect-color="" ng-reflect-disabled="false" type="button" (click)="openPopup()">
                        <svg _ngcontent-tjo-c219="" cIcon="" name="cil-pen" class="me-2 icon" ng-reflect-content="" ng-reflect-name="cil-chart" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" pointer-events="none" role="img">
                        </svg>
                    </button>
                    </td>
                </tr>
            </table>
              
                <div
                class="modal"
                tabindex="-1"
                role="dialog"
                [ngStyle]="{'display':displayStyle}">
                <div class="modal-dialog" role="document" >
                    <div class="modal-content" style="background-color: rgb(230, 230, 230);">
                        <textarea #newName _ngcontent-tjo-c222="" cformcontrol="" id="floatingTextarea2" placeholder="Leave a comment here" ng-reflect-ng-style="[object Object]" type="text" class="form-control" style="height: 100px; margin: 20px; max-width: 460px;"></textarea>                        
                        <button (click)="closePopup(newName.value)" _ngcontent-tjo-c219="" cbutton="" class="me-1 btn btn-light" ng-reflect-active="false" ng-reflect-color="" ng-reflect-disabled="false" type="button"  style=" margin-bottom: 20px; max-width: 120px; margin-left: 350px; color: white; background-color: #3c4b64; border-color: #3c4b64;">
                        Modifier
                        </button>    
                    </div>
                </div>
            </div>
            </c-card-header>
          <c-card-body>
            <c-nav variant="tabs">
              <c-nav-item>
                <a [active]="true" [cTabContent]="tabContent1" routerLink="./" [tabPaneIdx]="0" cNavLink>
                  <svg cIcon class="me-2" name="cilHome"></svg>
                  Script
                </a>
              </c-nav-item>
              <c-nav-item>
                <a [cTabContent]="tabContent1" routerLink="./" [tabPaneIdx]="1" cNavLink>
                  <svg cIcon class="me-2" name="cilUser"></svg>
                  Excel
                </a>
              </c-nav-item>
            </c-nav>
            <c-tab-content #tabContent1="cTabContent" [activeTabPaneIdx]="1" cRounded="bottom">
              <c-tab-pane class="p-3 preview" role="tabpanel">
                <h4> {{fun.name}} </h4>
                <form cForm class="d-flex" style="margin-top: 20px;">
                  <label>Main Query</label>
                    <input #qer value="{{fun.query}}" style="border-width: 0px; margin-left: 20px; background-color:  rgb(240, 240, 240); border-radius: 20px; max-width: 900px;" _ngcontent-oem-c220="" aria-label="input example" cformcontrol="" placeholder="SQL script" type="text" ng-reflect-sizing="" ng-reflect-type="text" class="form-control">
                    <p *ngIf="visib == true" style="color: red;">Error!</p>
                    <button  (click)="apply('x', qer.value )" _ngcontent-tjo-c224="" cbutton="" color="secondary" id="button-addon2" type="button" class="btn" style="margin-left: 10px; border-radius:20px; border-color:rgb(190, 189, 189); background-color:  rgb(190, 189, 189);"> Apply </button>
                </form>
                <br>
                <label>Error Query</label>
                <input #qererr value="{{fun.query_error}}" style="border-width: 0px; margin-left: 20px; background-color:  rgb(240, 240, 240); border-radius: 20px; max-width: 900px;" _ngcontent-oem-c220="" aria-label="input example" cformcontrol="" placeholder="SQL script" type="text" ng-reflect-sizing="" ng-reflect-type="text" class="form-control">
                <c-card style="background-color: rgb(240, 240, 240); margin:15px; border-radius: 20px; border-color: rgb(240, 240, 240); padding: 20px;">
                <table *ngFor="let res of stringed; let i = index" [bordered]="true" cTable ng-reflect-hover="true" ng-reflect-striped="true" class="table table-hover table-striped" style="table-layout: fixed; width: 100%; background-color: rgb(250, 248, 248);">
                  <thead *ngIf="i == 0" cTableColor="dark">
                      <tr _ngcontent-tjo-c252="">
                          <th _ngcontent-tjo-c252="" scope="col">#</th>
                          <th *ngFor="let h of res" _ngcontent-tjo-c252="" scope="col">{{h}}</th>
                      </tr>
                  </thead>
                  <tbody  *ngIf="i > 0" _ngcontent-tjo-c252="">
                      <tr _ngcontent-tjo-c252="">
                          <th _ngcontent-tjo-c252="" scope="row">{{i}}</th>
                          <td *ngFor="let r of res" _ngcontent-tjo-c252="">{{r}}</td>
                      </tr>
                      
                  </tbody>
              </table>
                   </c-card>
              </c-tab-pane>
              <c-tab-pane class="p-3 preview" role="tabpanel">
                <p *ngIf="error == true">You have some errors in this function</p>
                <p *ngIf="error == false">You have no errors.</p>
                <button *ngIf="error == true" (click)="showExcel()" _ngcontent-tjo-c224="" cbutton="" color="secondary" id="button-addon2" type="button" class="btn" style="margin-left: 10px; border-radius:20px; border-color:rgb(190, 189, 189); background-color:  rgb(190, 189, 189);"> Show Excel </button>
                <table hidden name="excel-table" >
                      <div *ngFor="let res of stringed1; let i = index" >
                      <tr *ngIf="i == 0" _ngcontent-tjo-c252="">
                          <th _ngcontent-tjo-c252="" scope="col">#</th>
                          <th *ngFor="let h of res" _ngcontent-tjo-c252="" scope="col">{{h}}</th>
                      </tr>
                      <tr  *ngIf="i > 0" _ngcontent-tjo-c252="">
                          <th _ngcontent-tjo-c252="" scope="row">{{i}}</th>
                          <td *ngFor="let r of res" _ngcontent-tjo-c252="">{{r}}</td>
                      </tr>
                      </div>
              </table>
              </c-tab-pane>
            </c-tab-content>
          </c-card-body>
        </c-card>
    </c-col>
        
    <button (click)="save(name.value, qer.value, qererr.value)" _ngcontent-tjo-c219="" cbutton="" class="me-1 btn btn-light" ng-reflect-active="false" 
    ng-reflect-color="" ng-reflect-disabled="false" type="button"
    style="margin-bottom: 20px; margin-left: 900px; max-width: 120px; color: white; background-color: #3c4b64; border-color: #3c4b64;">
        Modifier
    </button>
</c-card>